
create table ITAR_ASSOC_SEC_ROLE_ACTION
(
  IDROLE   NUMBER(15),
  IDACTION NUMBER(15)
)
;

CREATE UNIQUE INDEX UNIQUE_ROLE_ACTION 
			  ON ITAR_ASSOC_SEC_ROLE_ACTION 
			  (IDROLE, IDACTION);

create table ITAR_ASSOC_SEC_USER_ROLE
(
  IDUSER NUMBER(15),
  IDROLE NUMBER(15)
)
;
CREATE TABLE WF_PROCESS_DEFINITION(
	id number(8,0) not null,
	workflow_name VARCHAR2(250)  ,
	checksum VARCHAR2(250)  ,
	pdef Blob  ,
	version number(8)  ,
	xml_file Blob   ,
	date_creation DATE  ,
	CONSTRAINT PK_WF_PROCESS_DEFINITION PRIMARY KEY (id)
);

CREATE UNIQUE INDEX UNIQUE_USER_ROLE 
			  ON ITAR_ASSOC_SEC_USER_ROLE 
			(IDUSER, IDROLE) 
;
  

create table ITAR_ATTACHEMENT
(
  ATTACHABLE_ID    VARCHAR2(255) not null,
  FILE_DESCRIPTION VARCHAR2(255) ,
  FILE_DATA        NUMBER(15) ,
  FILE_NAME        VARCHAR2(255) ,
  ATTACHABLE_TYPE  VARCHAR2(500) ,
  FILE_PATH        VARCHAR2(255) ,
  FILE_SIZE        NUMBER(15) ,
  FILE_ID          NUMBER(15) ,
  FILE_TYPE        NUMBER(15) ,
  IS_VIRTUAL       CHAR(1),
  extension  VARCHAR2(255) ,
  CONTENT_TYPE     VARCHAR2(255) ,
date_upload	DATE
)
;
alter table ITAR_ATTACHEMENT
  add primary key (FILE_ID);

create table ITAR_LIEUUNIT
(
  ID               NUMBER(15) not null,
  TYPE_LIEU        NUMBER(15),
  PARENT_LIEU_UNIT NUMBER(15),
  CODE             VARCHAR2(255),
  DATE_FIN_EFFET   DATE,
  DATE_DEBUT_EFFET DATE,
  LIBELLE_ARABE    VARCHAR2(255),
  LIBELLE          VARCHAR2(255)
)
;
alter table ITAR_LIEUUNIT
  add primary key (ID);


create table ITAR_LOCKITEM
(
  ID            NUMBER(15) not null,
  LOCKABLE_ID   VARCHAR2(255) ,
  USERID        VARCHAR2(255) ,
  LOCKABLE_TYPE VARCHAR2(500) ,
  DATE_LOCK     DATE 
)
;
alter table ITAR_LOCKITEM
  add primary key (ID, LOCKABLE_ID, USERID);

create table ITAR_REPOSITORYUNIT
(
  ID               NUMBER(15) not null,
  LIBELLE_ARABE    VARCHAR2(255) ,
  LIBELLE          VARCHAR2(255) ,
  DATE_DEBUT_EFFET DATE ,
  CODE             VARCHAR2(255) ,
  DATE_FIN_EFFET   DATE ,
  TYPE_ENTITE      VARCHAR2(255),
	PROPRIETE1	varchar(255),
PROPRIETE2	varchar(255),
PROPRIETE3	varchar(255),
PROPRIETE4	varchar(255),
PROPRIETE5	varchar(255)

)
;
alter table ITAR_REPOSITORYUNIT
  add primary key (ID);

create table ITAR_SECURITY_ACTION
(
  ID                 NUMBER(15) not null,
  VO_CLASS_NAME      VARCHAR2(255) ,
  SECURE          NUMBER(1) ,
  ACTION_DESCRIPTION VARCHAR2(255) ,
  ACTION_NAME        VARCHAR2(255) ,
  ACTION_CLASS_NAME  VARCHAR2(500) ,
  ACTION_ID          VARCHAR2(255) ,
  MODULENAME		 VARCHAR2(255),
  SOUSMODULENAME	 VARCHAR2(255),
  VO_AFTER           VARCHAR2(255),
  action_parent NUMBER(8)
)
;
alter table ITAR_SECURITY_ACTION
  add primary key (ID);
  
ALTER TABLE ITAR_SECURITY_ACTION add CONSTRAINT 
FK_ITAR_SECURITY_ACTION_parent 
FOREIGN KEY (action_parent) REFERENCES ITAR_SECURITY_ACTION(ID) ; 


create table ITAR_SECURITY_ROLE
(
  ID           NUMBER(15) not null,
  LIBELLE_ROLE VARCHAR2(255) ,
  CODE_ROLE    VARCHAR2(255) 
)
;
alter table ITAR_SECURITY_ROLE
  add primary key (ID);

create table ITAR_SECURITY_USER
(
  ID                          NUMBER(15) not null,
  PRENOM                      VARCHAR2(255),
  LOGIN                       VARCHAR2(255),
  CONNECTED                   NUMBER(15),
  UNITE_ORGANISATIONNELLE NUMBER(15),
  MOTDEPASSE                  VARCHAR2(255),
  NOM                         VARCHAR2(255),
  BLOCKED		      NUMBER(15)
)
;
alter table ITAR_SECURITY_USER
  add primary key (ID);

create table ITAR_TRACEOBJECT
(
  ID                NUMBER(15) not null,
  DATE_HEURE_TRACE  DATE,
  UNITE_ORG_USER    VARCHAR2(255),
  USER_TRACE        VARCHAR2(255),
  TRACE_INFO_BEFORE VARCHAR2(255),
  MODULE            VARCHAR2(255),
  ACTION            VARCHAR2(255),
  TRACE_INFO_AFTER  VARCHAR2(255),
  SOUSMODULE		VARCHAR2(255), 
  DUREE				NUMBER(15),
  TRACABLE_BEFORE   BLOB,
  TRACABLE_AFTER    BLOB
)
;
alter table ITAR_TRACEOBJECT
  add primary key (ID);

create table ITAR_UNITEORG
(
  ID                       NUMBER(15) not null,
  UNITE_ORGANIS_PARENT NUMBER(15) ,
  DATE_DEBUT_EFFET         DATE ,
  TYPE_ENTITE              NUMBER(15) ,
  EMAIL                    VARCHAR2(255) ,
  TIMBRE                   VARCHAR2(255) ,
  NOM_ABREGE               VARCHAR2(255) ,
  DATE_FIN_EFFET           DATE ,
  NOM                      VARCHAR2(255) ,
  IS_REGISSEUR             NUMBER(15) , 
  REFLIEU				   NUMBER(15)
)
;
alter table ITAR_UNITEORG
  add primary key (ID);

ALTER TABLE "ITAR_UNITEORG" ADD CONSTRAINT "ITAR_UNITEORG_ITAR_UNITEO_FK" FOREIGN KEY ("UNITE_ORGANIS_PARENT")
	  REFERENCES "ITAR_UNITEORG" ("ID") ENABLE;

CREATE TABLE ITAR_HISTORYITEM 
   ( ID NUMBER NOT NULL, 
	IDHISTORISABLE NUMBER(15), 
	NUMVERSION NUMBER(15), 
	SERIALISATION BLOB, 
	NOMCLASSE VARCHAR2(500), 
	UTILISATEUR VARCHAR2(255), 
	DATEVERSION DATE, 
	ACTIONHISTORIQUE VARCHAR2(255)
);
alter table ITAR_HISTORYITEM
  add primary key (ID);

CREATE TABLE ITAR_HISTORYITEMLINKS 
   (	IDPARENT VARCHAR2(255), 
	IDCHILD VARCHAR2(255), 
	NOMATTRIBUT VARCHAR2(255), 
	ID NUMBER(15)
);

CREATE TABLE ITAR_GENERATEUR 
   ( ID NUMBER NOT NULL, 
	CODE VARCHAR2(15), 
	NEXTVALUE NUMBER(15)
);
alter table ITAR_GENERATEUR
  add primary key (ID);

CREATE TABLE  WF_ACTION
   (	
	ID NUMBER NOT NULL ENABLE, 
	WORKFLOW_NAME VARCHAR2(250) NOT NULL ENABLE, 
	TRANSITION_NAME VARCHAR2(250) NOT NULL ENABLE, 
	ENTITY VARCHAR2(250) NOT NULL ENABLE, 
	ACTION_ID VARCHAR2(4000), 
	CONSTRAINT WF_ACTION_CON PRIMARY KEY (WORKFLOW_NAME, TRANSITION_NAME, ENTITY) ENABLE
   );
   
 CREATE TABLE  TB_WORKFLOW_LOGS 
   (	
	ID NUMBER NOT NULL ENABLE, 
	PREVIOUS_STATE VARCHAR2(4000), 
	CURRENT_STATE VARCHAR2(4000), 
	INSTANCE_IDENTIFIER VARCHAR2(4000), 
	DATE_CHANGE DATE, 
	PROECSS_NAME VARCHAR2(4000), 
	UTILISATEUR NUMBER, 
	UORG NUMBER, 
	 CONSTRAINT TB_WORKFLOW_LOGS_CON PRIMARY KEY (ID) ENABLE
   );
   
   CREATE TABLE  TB_PROCESS_INSTANCE 
   (	
	ID NUMBER, 
	SERIALIZATION BLOB, 
	NAME VARCHAR2(4000), 
	INSTANCE_IDENTIFIER VARCHAR2(4000), 
        id_workflow_process_definition NUMBER,
	CONSTRAINT PROCESS_INSTANCE_PK PRIMARY KEY (ID) ENABLE
   );

CREATE SEQUENCE  SEQ_ITAR_GENERATEUR  
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1;


CREATE SEQUENCE  SEQ_ITAR_ATTACHEMENT  
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1;

CREATE SEQUENCE  SEQ_ITAR_LIEUUNIT  
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1000 ;

CREATE SEQUENCE  SEQ_ITAR_SECURITY_ACTION  
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 10000 ;

CREATE SEQUENCE  SEQ_ITAR_SECURITY_ROLE  
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1000 ;

CREATE SEQUENCE  SEQ_ITAR_SECURITY_USER 
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1000 ;

CREATE SEQUENCE  SEQ_ITAR_REPOUNIT  
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1000 ;

CREATE SEQUENCE  SEQ_ITAR_TRACEOBJECT  
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1 ;

CREATE SEQUENCE  SEQ_ITAR_UNITEORG 
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1000 ;

CREATE SEQUENCE SEQ_ITAR_HISTORYITEM
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1000 ;

CREATE SEQUENCE SEQ_ITAR_HISTORYITEMLINKS
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1000 ;

CREATE SEQUENCE  SEQ_ITAR_LOCKITEM
MINVALUE 1 MAXVALUE 999999999999999999999999999
INCREMENT BY 1 START WITH 1000 ;

CREATE SEQUENCE  SEQ_TB_PROCESS_INSTANCE  
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1;

CREATE SEQUENCE  SEQ_TB_WORKFLOW_LOGS  
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1;

CREATE SEQUENCE  SEQ_WF_ACTION
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1;



--ajouter la table itar_attachable 
create table ITAR_ATTACHABLE_CONFIG
(
	ID 			NUMBER(15) ,
	ATTACHABLE_TYPE  	VARCHAR2(500) ,
  	CRITERE		VARCHAR2(255) ,
  	IS_EXTENSIBLE 		char(1)
)
;
alter table ITAR_ATTACHABLE_CONFIG
  add primary key (ID);

CREATE SEQUENCE  SEQ_ITAR_ATTACHABLE_CONFIG  
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1;
--ajouter la table itar_type_attachable

create table ITAR_TYPE_ATTACHABLE
(
	ID		 			NUMBER(15) ,
	NOMBRE  			NUMBER(15) ,
  	IS_REQUIRED 		CHAR(1),
  	ID_TYPE_ATTACHEMENT NUMBER(15),
	ID_ATTACHABLE		NUMBER(15),
ID_Groupe_TYPE_ATTACHEMENT NUMBER(15),
NOMBRE_UPLOAD  			NUMBER(15) 
)
;
alter table ITAR_TYPE_ATTACHABLE
  add primary key (ID);

CREATE SEQUENCE  SEQ_TYPE_ATTACHABLE_CONFIG  
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1;

ALTER TABLE "ITAR_TYPE_ATTACHABLE" ADD CONSTRAINT "ITAR_TATT_ITAR_TATTACHEMENT_FK" 
FOREIGN KEY ("ID_TYPE_ATTACHEMENT") REFERENCES "ITAR_REPOSITORYUNIT" ("ID") ENABLE;

ALTER TABLE "ITAR_TYPE_ATTACHABLE" ADD CONSTRAINT "ITAR_TATTACHABLE_ITAR_ATT_FK" 
FOREIGN KEY ("ID_ATTACHABLE") REFERENCES "ITAR_ATTACHABLE_CONFIG" ("ID") ENABLE;


--ajouter table association 

CREATE TABLE ITAR_ASSOC_GRTYPEATT_TYPEATT
(
	ID_GROUPE_TYPE_ATTACHEMENT		 NUMBER(15) ,
	ID_TYPE_ATTACHEMENT		 		NUMBER(15) 
)
;
CREATE UNIQUE INDEX UNIQUE_ROLE_TYPEATT
			  ON ITAR_ASSOC_GRTYPEATT_TYPEATT 
			  (ID_GROUPE_TYPE_ATTACHEMENT, ID_TYPE_ATTACHEMENT);

--ajout table attachable config par instance
create table ITAR_ATTACHABLE_CONFIG_INST
(
	ID 			number(8,0) ,
	ATTACHABLE_ID number(8,0) ,
	TYPE_ATTACHABLE_ID number(8,0) ,
	ATTACHABLE_TYPE  	VARCHAR2(255) ,
  	CRITERE		VARCHAR2(255) ,
  	is_Required 		char(1),
	is_Ramene 		char(1),
	nombre number(8,0) ,
	id_TypeAttachement number(8,0) ,
	id_GroupeTypeAttachement number(8,0),
	typeAttGroupe_Ramenes VARCHAR2(255),
	id_attachement number(8,0),
	attachements VARCHAR2(255) ,
    CONSTRAINT ITAR_ATTACHABLE_CONFIG_INST_PK PRIMARY KEY (ID)
)
;
alter table ITAR_ATTACHABLE_CONFIG_INST
  add primary key (ID);

CREATE SEQUENCE  SEQ_ITAR_ATTACHABLE_CONFINST
MINVALUE 1 MAXVALUE 999999999999999999999999999 
INCREMENT BY 1 START WITH 1;

ALTER TABLE "ITAR_ATTACHABLE_CONFIG_INST" ADD CONSTRAINT "ITAR_CONFINST_TYPEATT_FK" 
FOREIGN KEY ("ID_TYPEATTACHEMENT") REFERENCES "ITAR_REPOSITORYUNIT" ("ID") ENABLE;

ALTER TABLE "ITAR_ATTACHABLE_CONFIG_INST" ADD CONSTRAINT "ITAR_CONFINST_GPTYPEATT_FK" 
FOREIGN KEY ("ID_GROUPETYPEATTACHEMENT") REFERENCES "ITAR_REPOSITORYUNIT" ("ID") ENABLE;


--------------------------------------------------------
--  Fichier cr?? - mardi-mars-06-2012
--------------------------------------------------------
--------------------------------------------------------
--  DDL for Table TB_AFFE_USER_ROLE_UO
--------------------------------------------------------
CREATE TABLE "TB_AFFE_USER_ROLE_UO"
  (
    "IDUSER"                      NUMBER(15,0),
    "ROLE"                    NUMBER(15,0),
    "UNITY_ORGANISATIONNELLE" NUMBER(15,0),
    "ID"                          NUMBER(15,0)
  ) ;
--------------------------------------------------------
--  DDL for Index TB_AFFECTATION_USER_ROLE__UK1
--------------------------------------------------------
CREATE UNIQUE INDEX "TB_AFFECTATION_USER_ROLE__UK1" ON "TB_AFFE_USER_ROLE_UO"
  (
    "ROLE", "UNITY_ORGANISATIONNELLE"
  )
  ;
  --------------------------------------------------------
  --  Constraints for Table TB_AFFE_USER_ROLE_UO
  --------------------------------------------------------
  ALTER TABLE "TB_AFFE_USER_ROLE_UO" MODIFY
  (
    "ID" NOT NULL ENABLE
  )
  ;
  ALTER TABLE "TB_AFFE_USER_ROLE_UO" ADD CONSTRAINT "TB_AFFECTATION_USER_ROLE__UK1" UNIQUE
  (
    "ROLE", "UNITY_ORGANISATIONNELLE"
  )
  ;